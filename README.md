# D4 Helper - Sanctuary Edition (v2.1)

![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Version](https://img.shields.io/badge/version-1.0.1-green.svg)
![Platform](https://img.shields.io/badge/platform-Windows-lightgrey.svg)

![D4 Helper v2.1 UI](./docs/images/ui_screenshot_v2.1.png)

ë””ì•„ë¸”ë¡œ 4 í”Œë ˆì´ì–´ë¥¼ ìœ„í•œ **ìŠ¤í‚¬ ìë™ ì‚¬ìš© ë„ìš°ë¯¸**ì…ë‹ˆë‹¤.  
ë°˜ë³µì ì¸ ìŠ¤í‚¬ ì…ë ¥ì„ ìë™í™”í•˜ì—¬ ì†ëª© í”¼ë¡œë¥¼ ì¤„ì´ê³  ê²Œì„ í”Œë ˆì´ì— ë”ìš± ì§‘ì¤‘í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì¤ë‹ˆë‹¤.

# D4 Helper í”„ë¡œì íŠ¸ ì¢…í•© ë¶„ì„ (í•œêµ­ì–´)

> **ì‘ì„±ì¼**: 2025-12-06  
> **ë²„ì „**: v1.0.1

---

## ğŸ“‹ ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ê°œìš”](#í”„ë¡œì íŠ¸-ê°œìš”)
2. [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
3. [í‚¤ë³´ë“œ ë§¤í¬ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬](#í‚¤ë³´ë“œ-ë§¤í¬ë¡œ-ë¼ì´ë¸ŒëŸ¬ë¦¬)
4. [ê¸°ìˆ  ìŠ¤íƒ ìƒì„¸](#ê¸°ìˆ -ìŠ¤íƒ-ìƒì„¸)
5. [í•µì‹¬ ê¸°ëŠ¥ ë¶„ì„](#í•µì‹¬-ê¸°ëŠ¥-ë¶„ì„)
6. [ë°ì´í„° íë¦„ ë° í†µì‹ ](#ë°ì´í„°-íë¦„-ë°-í†µì‹ )
7. [ë¬¸ì œ í•´ê²° íˆìŠ¤í† ë¦¬](#ë¬¸ì œ-í•´ê²°-íˆìŠ¤í† ë¦¬)
 
### ğŸ“Œ í•µì‹¬ íŠ¹ì§•

- **í”Œë«í¼**: Windows 10/11 (64-bit) ì „ìš©
- **UI í¬ê¸°**: 900 x 600 í”½ì…€ (ê³ ì • í¬ê¸°)
- **ë‹¤êµ­ì–´ ì§€ì›**: í•œêµ­ì–´, English, æ—¥æœ¬èª, ç®€ä½“ä¸­æ–‡
- **í…Œë§ˆ**: ë””ì•„ë¸”ë¡œ 4 ê²Œì„ ë¶„ìœ„ê¸°ì— ë§ì¶˜ ë‹¤í¬ ë ˆë“œ ê³ ë”• í…Œë§ˆ
- **ë¼ì´ì„ ìŠ¤**: MIT License (êµìœ¡ ëª©ì )

### ğŸ¯ ì£¼ìš” ê¸°ëŠ¥

1. **8ê°œ ìŠ¤í‚¬ ìŠ¬ë¡¯ ì‹œìŠ¤í…œ** - ê° ìŠ¬ë¡¯ì— í‚¤ì™€ ì‹¤í–‰ ê°„ê²© ì„¤ì • (0~5000ms)
2. **F1 ê¸€ë¡œë²Œ ë‹¨ì¶•í‚¤** - ê²Œì„ ì¤‘ì—ë„ ë§¤í¬ë¡œ ì‹œì‘/ì •ì§€ ê°€ëŠ¥
3. **Stop Keys ê¸°ëŠ¥** - ë””ì•„ë¸”ë¡œ UI(ì¸ë²¤í† ë¦¬, ë§µ ë“±) ì—´ ë•Œ ìë™ ì¼ì‹œì •ì§€
4. **Special Key** - íŠ¹ì • í‚¤ë¥¼ ëˆ„ë¥´ëŠ” ë™ì•ˆ ì¼ì‹œì •ì§€
5. **ë§ˆìš°ìŠ¤ ë²„íŠ¼ ì§€ì›** - ì¢Œí´ë¦­, ìš°í´ë¦­, íœ í´ë¦­ ë§¤í¬ë¡œ ê°€ëŠ¥
6. **ì„¤ì • ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸°** - ë¡œì»¬ ì„¤ì • íŒŒì¼ë¡œ í”„ë¡œí•„ ê´€ë¦¬

---

## ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ğŸ—ï¸ ì „ì²´ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

```mermaid
sequenceDiagram
    participant UI as Frontend (React UI)
    participant State as State Management
    participant IPC as IPC Bridge
    participant Main as Backend (Main)
    participant Macro as Macro Engine
    participant Native as Native Module (@nut-tree/nut-js)
    participant OS as System (Windows API)

    Note over UI, OS: ì‹œìŠ¤í…œ ì´ˆê¸°í™” ë° ë§¤í¬ë¡œ ì‹¤í–‰ íë¦„

    UI->>State: ì‚¬ìš©ì ì•¡ì…˜ (ì‹œì‘ ë²„íŠ¼)
    State->>IPC: IPC ë©”ì‹œì§€ ì „ì†¡ (macro:start)
    IPC->>Main: ë©”ì¸ í”„ë¡œì„¸ìŠ¤ë¡œ ì „ë‹¬
    Main->>Macro: ë§¤í¬ë¡œ ì—”ì§„ ì‹œì‘ ìš”ì²­

    loop ë§¤í¬ë¡œ ì‹¤í–‰ ì£¼ê¸°
        Macro->>Native: í‚¤ ì…ë ¥ ëª…ë ¹
        Native->>OS: SendInput (Scan Code)
        OS-->>Native: ì…ë ¥ ì²˜ë¦¬ ì™„ë£Œ
    end

    Macro-->>Main: ìƒíƒœ ì—…ë°ì´íŠ¸
    Main-->>IPC: ìƒíƒœ ì „ì†¡ (status:update)
    IPC-->>State: ìƒíƒœ ìˆ˜ì‹ 
    State-->>UI: UI ì—…ë°ì´íŠ¸ (Running í‘œì‹œ)
```

### ğŸ”„ ë°ì´í„° íë¦„ ì•„í‚¤í…ì²˜

```mermaid
sequenceDiagram
    participant User
    participant UI as React UI
    participant Main as Electron Main
    participant System as Windows OS

    User->>UI: F1 í‚¤ ì…ë ¥ (ì‹œì‘)
    UI->>Main: ë§¤í¬ë¡œ ì‹œì‘ ìš”ì²­

    loop ì‹¤í–‰ ì¤‘
        Main->>System: í‚¤ ì…ë ¥ ì „ì†¡ (Scan Code)
        System-->>User: ê²Œì„ ë‚´ ìŠ¤í‚¬ ë°œë™
    end

    Main-->>UI: ìƒíƒœ ì—…ë°ì´íŠ¸ (Running)
    UI-->>User: ë…¹ìƒ‰ ë¶ˆë¹› í‘œì‹œ
```

### ğŸ—‚ï¸ í”„ë¡œì íŠ¸ êµ¬ì¡° ë‹¤ì´ì–´ê·¸ë¨

```mermaid
graph LR
    Project[dia4helper]

    Project --> Electron["electron/<br>ë°±ì—”ë“œ ë¡œì§"]
    Project --> Src["src/<br>React UI"]
    Project --> Docs["docs/<br>ë¬¸ì„œ"]

    Electron --> Main[main.ts]
    Electron --> Preload[preload.ts]

    Src --> Components[components/]
    Src --> Locales[locales/]
```

### ğŸ” ë³´ì•ˆ ì•„í‚¤í…ì²˜

```mermaid
graph LR
    Renderer["Renderer Process<br>(UI / ë‚®ì€ ê¶Œí•œ)"]
    Bridge["IPC Bridge<br>(ë³´ì•ˆ í†µë¡œ)"]
    Main["Main Process<br>(ì‹œìŠ¤í…œ ì ‘ê·¼ / ë†’ì€ ê¶Œí•œ)"]

    Renderer -->|ì œí•œëœ ìš”ì²­| Bridge
    Bridge -->|ê²€ì¦ëœ í˜¸ì¶œ| Main
```

---

## í‚¤ë³´ë“œ ë§¤í¬ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬

### ğŸ“š ì‚¬ìš©ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬

ì´ í”„ë¡œì íŠ¸ëŠ” í‚¤ë³´ë“œ ë§¤í¬ë¡œ êµ¬í˜„ì„ ìœ„í•´ ë‹¤ìŒ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤:

#### 1. **@nut-tree-fork/nut-js** (í˜„ì¬ ì‚¬ìš© ì¤‘) âœ…

```json
"@nut-tree-fork/nut-js": "^4.2.6"
```

**íŠ¹ì§•:**

- Node.jsìš© í¬ë¡œìŠ¤ í”Œë«í¼ ë°ìŠ¤í¬í†± ìë™í™” ë¼ì´ë¸ŒëŸ¬ë¦¬
- í‚¤ë³´ë“œ, ë§ˆìš°ìŠ¤, í™”ë©´ ì œì–´ ê°€ëŠ¥
- **Scan Code ì „ì†¡ ì§€ì›** - DirectX ê²Œì„ì—ì„œ ì‘ë™
- TypeScript íƒ€ì… ì •ì˜ í¬í•¨

**ì¥ì :**

- âœ… ë””ì•„ë¸”ë¡œ 4 ê°™ì€ DirectX ê²Œì„ì—ì„œ ì •ìƒ ì‘ë™
- âœ… ì„¤ì¹˜ê°€ ë¹„êµì  ê°„ë‹¨ (node-gyp ë¶ˆí•„ìš”)
- âœ… í™œë°œí•œ ìœ ì§€ë³´ìˆ˜ (fork ë²„ì „)
- âœ… Promise ê¸°ë°˜ APIë¡œ async/await ì‚¬ìš© ê°€ëŠ¥

**ë‹¨ì :**

- âš ï¸ ë„¤ì´í‹°ë¸Œ ëª¨ë“ˆ ì˜ì¡´ì„± (ì¼ë¶€ í™˜ê²½ì—ì„œ ë¹Œë“œ ì´ìŠˆ)

**ì‚¬ìš© ì˜ˆì‹œ:**

```typescript
import { keyboard, Key } from "@nut-tree-fork/nut-js";

// í‚¤ ì…ë ¥
await keyboard.type(Key.A);
await keyboard.pressKey(Key.LeftShift);
```

#### 2. **koffi** (FFI ìš©ë„)

```json
"koffi": "^2.14.1"
```

**íŠ¹ì§•:**

- Node.jsìš© FFI (Foreign Function Interface) ë¼ì´ë¸ŒëŸ¬ë¦¬
- C/C++ ë„¤ì´í‹°ë¸Œ ì½”ë“œë¥¼ ì§ì ‘ í˜¸ì¶œ ê°€ëŠ¥
- Windows API ì§ì ‘ ì ‘ê·¼ìš©

**ìš©ë„:**

- Windows SendInput API ì§ì ‘ í˜¸ì¶œ
- ë” ì •ë°€í•œ í‚¤ ì…ë ¥ ì œì–´
- í•˜ë“œì›¨ì–´ ìŠ¤ìº” ì½”ë“œ ì „ì†¡

**ì‚¬ìš© ì˜ˆì‹œ:**

```typescript
import koffi from "koffi";

const user32 = koffi.load("user32.dll");
const SendInput = user32.func("uint32 SendInput(uint32, INPUT*, int32)");
```

### ğŸš« ê³¼ê±°ì— ì‹œë„í–ˆë˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤

#### âŒ robotjs (ì œê±°ë¨)

**ë¬¸ì œì :**

1. **ì„¤ì¹˜ ì´ìŠˆ** - Python 2.7 ë° Visual Studio Build Tools í•„ìˆ˜
2. **node-gyp ë¹Œë“œ ì‹¤íŒ¨** - Windows í™˜ê²½ì—ì„œ ìì£¼ ì‹¤íŒ¨
3. **DirectX í˜¸í™˜ì„±** - Virtual Key Codeë§Œ ì „ì†¡í•˜ì—¬ ë””ì•„ë¸”ë¡œ 4ì—ì„œ ì‘ë™ ì•ˆ í•¨
4. **ìœ ì§€ë³´ìˆ˜ ì¤‘ë‹¨** - ì˜¤ë˜ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì—…ë°ì´íŠ¸ ì—†ìŒ

**ì—ëŸ¬ ì˜ˆì‹œ:**

```bash
npm install --global windows-build-tools
node-gyp rebuild
# ì˜¤ë¥˜: Python 2.7 not found
# ì˜¤ë¥˜: MSBuild.exe not found
```

**GEMINI.mdì—ì„œ ì–¸ê¸‰:**

> ### 1. robotjs ì„¤ì¹˜ ë¬¸ì œ
>
> - **ì¦ìƒ**: `node-gyp rebuild` ì‹¤íŒ¨
> - **ì›ì¸**: Python 2.7 ë° Visual Studio Build Tools í•„ìš”

---

## ë¬¸ì œ í•´ê²° íˆìŠ¤í† ë¦¬

### ğŸ› ì£¼ìš” ì´ìŠˆì™€ í•´ê²° ê³¼ì •

#### Issue #1: DirectX ê²Œì„ì—ì„œ í‚¤ ì…ë ¥ ë¬´ì‹œ

**ì¦ìƒ:**

- ë©”ëª¨ì¥ì—ì„œëŠ” ì •ìƒ ì‘ë™
- ë””ì•„ë¸”ë¡œ 4ì—ì„œëŠ” í‚¤ ì…ë ¥ì´ ì „í˜€ ì¸ì‹ë˜ì§€ ì•ŠìŒ

**ì›ì¸ ë¶„ì„:**

```
DirectX ê²Œì„ì€ Virtual Key Codeë¥¼ ë¬´ì‹œí•˜ê³ 
í•˜ë“œì›¨ì–´ ìŠ¤ìº” ì½”ë“œ(Scan Code)ë§Œ ì¸ì‹í•¨
```

**í•´ê²° ê³¼ì •:**

```mermaid
graph LR
    A[robotjs ì‚¬ìš©] -->|ì‹¤íŒ¨| B[VKë§Œ ì „ì†¡]
    B --> C[nut.js ì‹œë„]
    C -->|ì„±ê³µ| D[Scan Code ì „ì†¡]
    D --> E["@nut-tree-fork/nut-js"]
```

**ìµœì¢… ì†”ë£¨ì…˜:**

```typescript
// âŒ ì‘ë™ ì•ˆ í•¨ (Virtual Keyë§Œ ì „ì†¡)
robot.keyTap("a");

// âœ… ì‘ë™í•¨ (Scan Code ì „ì†¡)
import { keyboard, Key } from "@nut-tree-fork/nut-js";
await keyboard.type(Key.A);
```

**docs/bug_guide.md ë°œì·Œ:**

> Standard virtual key codes (VK) sent by libraries like `robotjs` or `nut.js` are often ignored by DirectX games (like Diablo 4) because they poll hardware scan codes directly.
>
> **Solution**: Use Scan Codes - ensure the FFI library populates the `wScan` field of the `KEYBDINPUT` structure and sets the `KEYEVENTF_SCANCODE` flag.

---

#### Issue #2: ê¸€ë¡œë²Œ ë‹¨ì¶•í‚¤ ì œì•½

**ì¦ìƒ:**

- Tab, Enter, Esc í‚¤ê°€ Stop Keysë¡œ ì‘ë™ ì•ˆ í•¨
- ì¼ë¶€ ì‹œìŠ¤í…œ ì˜ˆì•½ í‚¤ ë“±ë¡ ë¶ˆê°€

**ì›ì¸:**

```
Windows OSê°€ íŠ¹ì • í‚¤ë¥¼ ì‹œìŠ¤í…œ ë ˆë²¨ì—ì„œ ê°€ë¡œì±”
í‘œì¤€ Electron globalShortcut APIì˜ í•œê³„
```

**í•´ê²° ë°©ë²•:**

```mermaid
graph TB
    A[Global Shortcut ì‹¤íŒ¨] --> B{ëŒ€ì•ˆ ê²€í† }
    B --> C[Low-Level Hook]
    B --> D[ì‘ë™í•˜ëŠ” í‚¤ë§Œ ì‚¬ìš©]
    C --> E[WH_KEYBOARD_LL êµ¬í˜„]
    D --> F[F1, C, K, M ë“± í—ˆìš©]
```

**ê¶Œì¥ ì‚¬í•­:**

- âœ… F1~F12: ëŒ€ë¶€ë¶„ ì‘ë™
- âœ… C, K, M, F: ì‘ë™
- âš ï¸ Tab: ì‹œìŠ¤í…œ ì œì•½ìœ¼ë¡œ ë¶ˆì•ˆì •
- âŒ Win, Esc: ë“±ë¡ ë¶ˆê°€

---

#### Issue #3: ë¹Œë“œ ì˜ì¡´ì„± ë¬¸ì œ

**ì¦ìƒ:**

```bash
npm install
# ì˜¤ë¥˜: node-gyp rebuild failed
# ì˜¤ë¥˜: Python 2 not found
```

**í•´ê²° ê³¼ì •:**

| ë‹¨ê³„ | ì‹œë„                       | ê²°ê³¼             |
| ---- | -------------------------- | ---------------- |
| 1    | robotjs ì‚¬ìš©               | âŒ node-gyp ì‹¤íŒ¨ |
| 2    | windows-build-tools ì„¤ì¹˜   | âš ï¸ 2ì‹œê°„+ ì†Œìš”   |
| 3    | pre-built binaries ê²€ìƒ‰    | âŒ ë²„ì „ ë¶ˆì¼ì¹˜   |
| 4    | @nut-tree-fork/nut-js ì „í™˜ | âœ… ì„¤ì¹˜ ì„±ê³µ     |

**ìµœì¢… ì†”ë£¨ì…˜:**

```json
{
  "dependencies": {
    "@nut-tree-fork/nut-js": "^4.2.6", // âœ… node-gyp ë¶ˆí•„ìš”
    "koffi": "^2.14.1" // âœ… FFI ìš©ë„
  }
}
```

---

#### Issue #4: ë‹¤êµ­ì–´ ìƒíƒœ í‘œì‹œ ì˜¤ë¥˜

**ì¦ìƒ:**

- ìƒíƒœê°€ "Running"ìœ¼ë¡œ í•˜ë“œì½”ë”©ë¨
- ì–¸ì–´ ë³€ê²½ ì‹œ ì¼ë¶€ í…ìŠ¤íŠ¸ë§Œ ë²ˆì—­ë¨

**ì›ì¸:**

```typescript
// âŒ ì˜ëª»ëœ ì½”ë“œ
const statusText = currentStatus.state === "running" ? "Running" : "Stopped";
```

**í•´ê²°:**

```typescript
// âœ… ì˜¬ë°”ë¥¸ ì½”ë“œ
const statusText = t(`status.${currentStatus.state}`);

// locales/ko/translation.json
{
  "status": {
    "running": "ì‹¤í–‰ ì¤‘",
    "stopped": "ì •ì§€ë¨",
    "paused": "ì¼ì‹œì •ì§€"
  }
}
```

---

#### Issue #5: ê°„ê²© ë„ˆë¬´ ì§§ì„ ë•Œ CPU ê³¼ë¶€í•˜

**ì¦ìƒ:**

- ê°„ê²©ì„ 10ms ì´í•˜ë¡œ ì„¤ì • ì‹œ CPU 100% ì‚¬ìš©
- í”„ë¡œê·¸ë¨ ë²„ë²…ì„ ë° ì‘ë‹µ ì—†ìŒ

**ë¶„ì„:**

```
setInterval(callback, 10) ë°˜ë³µ í˜¸ì¶œ
â†’ 1ì´ˆë‹¹ 100íšŒ ì´ë²¤íŠ¸ ë£¨í”„
â†’ CPU ê³¼ë¶€í•˜
```

**í•´ê²° ë°©ë²•:**

```mermaid
graph LR
    A[UI ì œì•½ ì¶”ê°€] --> B[ìŠ¬ë¼ì´ë” ìµœëŒ€ 2000ms]
    A --> C[ì…ë ¥ í•„ë“œ ìµœëŒ€ 5000ms]
    A --> D[ê²½ê³  ë©”ì‹œì§€ í‘œì‹œ]
    D --> E[50ms ë¯¸ë§Œ ì‹œ ê²½ê³ ]
```

**ê¶Œì¥ ê°„ê²©:**

- ì¼ë°˜ ìŠ¤í‚¬: 500~1000ms
- ë¹ ë¥¸ ìŠ¤í‚¬: 100~300ms
- ìµœì†Œê°’: 50ms (ì•ˆì „)

---

## ê¸°ìˆ  ìŠ¤íƒ ìƒì„¸

### ğŸ¨ í”„ë¡ íŠ¸ì—”ë“œ

| ê¸°ìˆ               | ë²„ì „    | ì—­í•           | íŠ¹ì§•                                  |
| :---------------- | :------ | :------------ | :------------------------------------ |
| **React**         | 18.2.0  | UI í”„ë ˆì„ì›Œí¬ | Hooks ê¸°ë°˜ ìƒíƒœ ê´€ë¦¬, ì»´í¬ë„ŒíŠ¸ ì¬ì‚¬ìš© |
| **TypeScript**    | 5.3.0   | ê°œë°œ ì–¸ì–´     | ê°•ë ¥í•œ íƒ€ì… ì‹œìŠ¤í…œ, ì¸í…”ë¦¬ì„¼ìŠ¤ ì§€ì›   |
| **Vite**          | 5.0.0   | ë¹Œë“œ ë„êµ¬     | ë¹ ë¥¸ HMR, ìµœì í™”ëœ ë²ˆë“¤ë§             |
| **i18next**       | 23.7.0  | ë‹¤êµ­ì–´ ì²˜ë¦¬   | 4ê°œ ì–¸ì–´(í•œ/ì˜/ì¼/ì¤‘) ì§€ì›, ë™ì  ì „í™˜ |
| **Framer Motion** | ^10.0.0 | ì• ë‹ˆë©”ì´ì…˜    | ë¶€ë“œëŸ¬ìš´ ìƒíƒœ ì „í™˜, ì œìŠ¤ì²˜ ì§€ì›       |

### âš™ï¸ ë°±ì—”ë“œ

| ê¸°ìˆ                | ë²„ì „   | ì—­í•           | íŠ¹ì§•                                           |
| :----------------- | :----- | :------------ | :--------------------------------------------- |
| **Electron**       | 27.0.0 | ì•± í”„ë ˆì„ì›Œí¬ | ë°ìŠ¤í¬í†± ë„¤ì´í‹°ë¸Œ í†µí•©, í”„ë¡œì„¸ìŠ¤ ê´€ë¦¬          |
| **nut.js** (Fork)  | 4.2.6  | ë§¤í¬ë¡œ ì—”ì§„   | í‚¤ë³´ë“œ ì œì–´, **Scan Code ì „ì†¡** (DirectX í˜¸í™˜) |
| **electron-store** | 8.1.0  | ë°ì´í„° ì €ì¥ì†Œ | ì„¤ì •ê°’ ìë™ ì €ì¥/ë³µì› (JSON)                   |
| **koffi**          | 2.14.1 | FFI (Native)  | Windows API ì§ì ‘ í˜¸ì¶œ (SendInput)              |

### ğŸ¨ UI/UX ë””ìì¸ ì‹œìŠ¤í…œ

#### ìƒ‰ìƒ íŒ”ë ˆíŠ¸

```css
/* ë‹¤í¬ í…Œë§ˆ */
--bg-primary: #1a1a1a; /* ë©”ì¸ ë°°ê²½ (ê±°ì˜ ê²€ì •) */
--bg-secondary: #242424; /* íŒ¨ë„ ë°°ê²½ */
--bg-tertiary: #2d2d2d; /* ì¹´ë“œ ë°°ê²½ */

/* ë””ì•„ë¸”ë¡œ ë ˆë“œ */
--accent-red: #7c3f3f; /* ë©”ì¸ ê°•ì¡°ìƒ‰ */
--border-red: #6b3030; /* ë ˆë“œ í…Œë‘ë¦¬ */

/* ê³¨ë“œ ì•¡ì„¼íŠ¸ */
--accent-gold: #d4af37; /* í‘œì¤€ ê³¨ë“œ */
--border-gold: #8b7355; /* ë¸Œë¡ ì¦ˆ/ê³¨ë“œ í…Œë‘ë¦¬ */
--text-gold: #c9aa71; /* ê³¨ë“œ í…ìŠ¤íŠ¸ */

/* ìƒíƒœ ìƒ‰ìƒ */
--accent-green: #4a7c3f; /* ì‹¤í–‰ ì¤‘ (ë…¹ìƒ‰) */
--text-red: #ff6b6b; /* ê²½ê³ /ì—ëŸ¬ */
```

#### íƒ€ì´í¬ê·¸ë˜í”¼

| ìš©ë„      | í°íŠ¸         | íŠ¹ì§•             |
| --------- | ------------ | ---------------- |
| ì œëª©/í—¤ë” | Cinzel       | ê³ ë”•/ì¤‘ì„¸ ìŠ¤íƒ€ì¼ |
| í•œêµ­ì–´    | Noto Sans KR | ê°€ë…ì„± ì¢‹ìŒ      |
| í‚¤ í‘œì‹œ   | Monospace    | ë“±í­ í°íŠ¸        |

---

## í•µì‹¬ ê¸°ëŠ¥ ë¶„ì„

### ğŸ¯ 8ê°œ ìŠ¤í‚¬ ìŠ¬ë¡¯ ì‹œìŠ¤í…œ

#### ê¸°ìˆ ì  êµ¬í˜„

```typescript
interface SkillSlotConfig {
  slotNumber: 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8;
  key: string; // '1', 'Q', 'Space', 'MouseLeft'
  interval: number; // 0~5000ms
  enabled: boolean; // í™œì„±í™” ì—¬ë¶€
}
```

#### ë™ì‘ íë¦„

```mermaid
sequenceDiagram
    participant User
    participant UI
    participant Main
    participant Interval
    participant NutJS

    User->>UI: F1 í‚¤ ì…ë ¥
    UI->>Main: startMacro()

    loop ê° í™œì„±í™”ëœ ìŠ¬ë¡¯
        Main->>Interval: setInterval(callback, slot.interval)

        loop ë§¤ intervalë§ˆë‹¤
            Interval->>Main: íƒ€ì´ë¨¸ ì½œë°±
            Main->>Main: state === 'running'?
            alt ì‹¤í–‰ ì¤‘
                Main->>NutJS: keyboard.type(slot.key)
                NutJS-->>User: í‚¤ ì…ë ¥ ì‹¤í–‰
            else ì¼ì‹œì •ì§€/ì •ì§€
                Main->>Main: í‚¤ ì…ë ¥ ê±´ë„ˆë›°ê¸°
            end
        end
    end
```

#### í•µì‹¬ ì½”ë“œ (electron/main.ts)

```typescript
function startMacro() {
  config.skillSlots.forEach((slot) => {
    if (slot.enabled && slot.key) {
      const timer = setInterval(async () => {
        if (currentStatus.state === "running") {
          // Scan Code ì „ì†¡
          await keyboard.type(Key[slot.key]);
        }
      }, slot.interval);

      macroIntervals.set(slot.slotNumber, timer);
    }
  });

  currentStatus.state = "running";
  sendStatusUpdate();
}
```

---

### ğŸ›‘ Stop Keys (ìë™ ì¼ì‹œì •ì§€)

#### ë§¤í•‘ í…Œì´ë¸”

```typescript
export const STOP_KEY_MAPPING = {
  inventory: "C", // ì¸ë²¤í† ë¦¬
  skills: "K", // ìŠ¤í‚¬ íŠ¸ë¦¬
  follower: "F", // ìš©ë³‘
  map: "Tab", // ë§µ
  worldMap: "M", // ì›”ë“œë§µ
  townPortal: "T", // ê·€í™˜ í¬í„¸
  chat: "Enter", // ì±„íŒ…
  whisper: "/", // ê·“ì†ë§
};
```

#### í† ê¸€ ë°©ì‹

```mermaid
stateDiagram-v2
    [*] --> Running
    Running --> Paused: Stop Key ëˆ„ë¦„
    Paused --> Running: Stop Key ë‹¤ì‹œ ëˆ„ë¦„
    Running --> Stopped: F1 ëˆ„ë¦„
    Stopped --> Running: F1 ëˆ„ë¦„
```

#### êµ¬í˜„ ë¡œì§

```typescript
// Stop Key ë“±ë¡
Object.entries(STOP_KEY_MAPPING).forEach(([name, key]) => {
  if (config.stopKeys[name]) {
    globalShortcut.register(key, () => {
      if (currentStatus.state === "running") {
        pauseMacro("stopKey");
      } else if (currentStatus.state === "paused") {
        resumeMacro();
      }
    });
  }
});
```

---

### ğŸ”‘ Special Key (Hold to Pause)

#### ë™ì‘ ë°©ì‹

```mermaid
stateDiagram-v2
    Running --> Paused_Special: Special Key Down
    Paused_Special --> Running: Special Key Up

    note right of Paused_Special
        í‚¤ë¥¼ ëˆ„ë¥´ê³  ìˆëŠ” ë™ì•ˆë§Œ ì¼ì‹œì •ì§€
        í‚¤ë¥¼ ë–¼ë©´ ì¦‰ì‹œ ì¬ê°œ
    end note
```

#### ì‚¬ìš© ì‚¬ë¡€

| ìƒí™©      | Special Key | íš¨ê³¼                |
| --------- | ----------- | ------------------- |
| ì •ë°€ ì¡°ì¤€ | Shift       | ì¡°ì¤€ ì¤‘ ë§¤í¬ë¡œ ì •ì§€ |
| ì´ë™      | Alt         | ì´ë™ ì¤‘ ìŠ¤í‚¬ ì •ì§€   |
| ìƒí˜¸ì‘ìš©  | Ctrl        | NPC ëŒ€í™” ì¤‘ ì •ì§€    |

---

## ë°ì´í„° íë¦„ ë° í†µì‹ 

### ğŸ”„ IPC í†µì‹  êµ¬ì¡°

```mermaid
graph LR
    UI[React App] <-->|IPC| Main[Electron Main]
    Main -->|ì œì–´| Engine[ë§¤í¬ë¡œ ì—”ì§„]
```

### ğŸ“¡ IPC ì±„ë„ ëª©ë¡

#### Renderer â†’ Main (Invoke)

| ì±„ë„ëª…            | íŒŒë¼ë¯¸í„°           | ì‘ë‹µ                 | ì„¤ëª…          |
| ----------------- | ------------------ | -------------------- | ------------- |
| `macro:start`     | -                  | `{success: boolean}` | ë§¤í¬ë¡œ ì‹œì‘   |
| `macro:stop`      | -                  | `{success: boolean}` | ë§¤í¬ë¡œ ì •ì§€   |
| `macro:pause`     | `{reason: string}` | `{success: boolean}` | ì¼ì‹œì •ì§€      |
| `macro:resume`    | -                  | `{success: boolean}` | ì¬ê°œ          |
| `config:save`     | `AppConfig`        | `{success: boolean}` | ì„¤ì • ì €ì¥     |
| `config:load`     | -                  | `AppConfig`          | ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸° |
| `window:minimize` | -                  | -                    | ì°½ ìµœì†Œí™”     |
| `window:maximize` | -                  | -                    | ì°½ ìµœëŒ€í™”     |
| `window:close`    | -                  | -                    | ì°½ ë‹«ê¸°       |

#### Main â†’ Renderer (Send)

| ì±„ë„ëª…          | í˜ì´ë¡œë“œ            | ì„¤ëª…               |
| --------------- | ------------------- | ------------------ |
| `status:update` | `MacroStatus`       | ì‹¤í–‰ ìƒíƒœ ì—…ë°ì´íŠ¸ |
| `error:notify`  | `{message: string}` | ì˜¤ë¥˜ ì•Œë¦¼          |

### ğŸ’¾ ì„¤ì • ì €ì¥ì†Œ

#### electron-store êµ¬ì¡°

```json
{
  "version": "1.0.1",
  "language": "ko",
  "startStopKey": "F1",
  "skillSlots": [
    {
      "slotNumber": 1,
      "key": "1",
      "interval": 11,
      "enabled": true
    }
    // ... 8ê°œ ìŠ¬ë¡¯
  ],
  "stopKeys": {
    "inventory": true,
    "skills": false
    // ...
  },
  "specialKey": {
    "key": "Shift",
    "enabled": false
  },
  "options": {
    "randomDelay": false,
    "randomDelayPercent": 10
  }
}
```

#### ì €ì¥ ìœ„ì¹˜

```
Windows: C:\Users\[Username]\AppData\Roaming\d4-helper\config.json
```

---

## ì„±ëŠ¥ ë° ìµœì í™”

### ğŸ“Š ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ë¥ 

| í•­ëª©   | Idle   | ì‹¤í–‰ ì¤‘ |
| ------ | ------ | ------- |
| ë©”ëª¨ë¦¬ | ~100MB | ~120MB  |
| CPU    | < 1%   | < 5%    |
| ë””ìŠ¤í¬ | 0 MB/s | 0 MB/s  |

### âš¡ ê¶Œì¥ ì„¤ì •

```typescript
// ê¶Œì¥ ê°„ê²© ë²”ìœ„
const RECOMMENDED_INTERVALS = {
  minimum: 50, // ìµœì†Œ 50ms (CPU ë¶€í•˜ ë°©ì§€)
  fast: 100, // ë¹ ë¥¸ ìŠ¤í‚¬ (íšŒí”¼, ì´ë™)
  normal: 500, // ì¼ë°˜ ìŠ¤í‚¬
  slow: 1000, // ì¿¨íƒ€ì„ ê¸´ ìŠ¤í‚¬
  maximum: 5000, // ìµœëŒ€ 5ì´ˆ
};
```

---

## ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### ğŸ”’ Electron ë³´ì•ˆ ì„¤ì •

```typescript
// electron/main.ts
const win = new BrowserWindow({
  webPreferences: {
    contextIsolation: true, // âœ… ì»¨í…ìŠ¤íŠ¸ ê²©ë¦¬
    nodeIntegration: false, // âœ… Node.js ì ‘ê·¼ ì°¨ë‹¨
    preload: path.join(__dirname, "preload.js"),
  },
});
```

### âš ï¸ ì‚¬ìš©ì ì£¼ì˜ì‚¬í•­

> **ê²½ê³ **: ì´ í”„ë¡œê·¸ë¨ì€ êµìœ¡ ëª©ì ìœ¼ë¡œ ì œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.
>
> 1. **ê²Œì„ ì´ìš©ì•½ê´€ ìœ„ë°˜ ê°€ëŠ¥**
>
>    - ëŒ€ë¶€ë¶„ì˜ ì˜¨ë¼ì¸ ê²Œì„ì€ ë§¤í¬ë¡œ ì‚¬ìš© ê¸ˆì§€
>    - ê³„ì • ì •ì§€ ë˜ëŠ” ì˜êµ¬ ì°¨ë‹¨ ìœ„í—˜
>
> 2. **ì•ˆí‹°ì¹˜íŠ¸ ê°ì§€ ê°€ëŠ¥**
>
>    - ì†Œí”„íŠ¸ì›¨ì–´ ë ˆë²¨ í‚¤ ì…ë ¥ ê°ì§€ë¨
>    - ê³µì‹ ì„œë²„ ì‚¬ìš© ì‹œ ìœ„í—˜ ê°ìˆ˜ í•„ìš”
>
> 3. **ê¶Œì¥ ì‚¬ìš© í™˜ê²½**
>    - ì˜¤í”„ë¼ì¸ ê²Œì„
>    - ê°œì¸ í…ŒìŠ¤íŠ¸ ì„œë²„
>    - êµìœ¡ ë° í•™ìŠµ ëª©ì 

---

## í–¥í›„ ê°œì„  ë°©í–¥

### ğŸš€ ê³„íšëœ ê¸°ëŠ¥

```mermaid
graph TB
    A[í˜„ì¬ v1.0.1] --> B[v1.1.0 - í”„ë¡œí•„ ì‹œìŠ¤í…œ]
    B --> C[v1.2.0 - ì¡°ê±´ë¶€ ì‹¤í–‰]
    C --> D[v2.0.0 - Flutter ì´ì‹]

    B --> B1[ë‹¤ì¤‘ í”„ë¡œí•„ ê´€ë¦¬]
    B --> B2[í”„ë¡œí•„ ë¹ ë¥¸ ì „í™˜]

    C --> C1[ì¡°ê±´ íŠ¸ë¦¬ê±°]
    C --> C2[ì´ë²¤íŠ¸ ê¸°ë°˜ ë§¤í¬ë¡œ]

    D --> D1[í¬ë¡œìŠ¤ í”Œë«í¼]
    D --> D2[ëª¨ë°”ì¼ ì§€ì›?]
```

### ğŸ“‹ ê°œì„  í•­ëª©

- [ ] **í”„ë¡œí•„ ì‹œìŠ¤í…œ** - ìºë¦­í„°/ë¹Œë“œë³„ ì„¤ì • ì €ì¥
- [ ] **íŠ¸ë ˆì´ ì•„ì´ì½˜** - ìµœì†Œí™” ì‹œ ì‹œìŠ¤í…œ íŠ¸ë ˆì´ë¡œ
- [ ] **ê¸€ë¡œë²Œ ì˜¤ë²„ë ˆì´** - ê²Œì„ ìœ„ íˆ¬ëª… UI
- [ ] **ë§¤í¬ë¡œ ë ˆì½”ë”©** - í‚¤ ì…ë ¥ ë…¹í™” ë° ì¬ìƒ
- [ ] **í´ë¦­ ìë™í™”** - ë§ˆìš°ìŠ¤ ìœ„ì¹˜ ì €ì¥ í›„ í´ë¦­
- [ ] **ì¡°ê±´ë¶€ íŠ¸ë¦¬ê±°** - HP/ë§ˆë‚˜ ê¸°ë°˜ ì‹¤í–‰
- [ ] **í†µê³„ ëŒ€ì‹œë³´ë“œ** - ì‚¬ìš© ì‹œê°„, ì…ë ¥ íšŸìˆ˜ í†µê³„

---

## ì°¸ê³  ìë£Œ

### ğŸ“š ë¬¸ì„œ ë§í¬

- [Electron ê³µì‹ ë¬¸ì„œ](https://www.electronjs.org/docs)
- [React ê³µì‹ ë¬¸ì„œ](https://react.dev)
- [nut.js ë¬¸ì„œ](https://nutjs.dev)
- [i18next ë¬¸ì„œ](https://www.i18next.com)

### ğŸ“ í”„ë¡œì íŠ¸ ë¬¸ì„œ

- [GEMINI.md](../GEMINI.md) - AI ì»¨í…ìŠ¤íŠ¸ ë¬¸ì„œ
- [PROJECT_SUMMARY.md](../PROJECT_SUMMARY.md) - í”„ë¡œì íŠ¸ ìš”ì•½
- [USER_MANUAL_KO.md](./USER_MANUAL_KO.md) - ì‚¬ìš©ì ë§¤ë‰´ì–¼
- [bug_guide.md](./bug_guide.md) - ë²„ê·¸ í•´ê²° ê°€ì´ë“œ

---

**ë¬¸ì„œ ë²„ì „**: 1.0  
**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-12-06  
**ì‘ì„±**: AI ë¶„ì„ ë¬¸ì„œ
